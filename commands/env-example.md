# /env-example - Generate .env.example from 1Password

Generate or update `.env.example` files by combining 1Password stored keys with environment variable references found in code.

## Workflow

### Step 1: Determine Project Context

1. Check for project name from:
   - `CLAUDE.md` project name
   - `package.json` name field
   - Directory name as fallback

2. Check for existing `.env.example`:
   - If exists, read current content for --sync mode
   - Note any custom comments to preserve

### Step 2: Query 1Password for Project Keys

1. Call `list_api_keys` MCP tool to get all stored keys

2. Filter relevant keys:
   - Keys tagged with project name (if available)
   - Common keys that most projects use (DATABASE_URL, etc.)
   - Keys matching patterns found in codebase

### Step 3: Scan Codebase for Environment Variable Usage

Search for all environment variable references:

**JavaScript/TypeScript:**
- `process.env.VARIABLE_NAME`
- `import.meta.env.VARIABLE_NAME`

**Python:**
- `os.environ["VARIABLE_NAME"]`
- `os.environ.get("VARIABLE_NAME")`
- `os.getenv("VARIABLE_NAME")`

**Ruby:**
- `ENV["VARIABLE_NAME"]`
- `ENV.fetch("VARIABLE_NAME")`

**Rust:**
- `std::env::var("VARIABLE_NAME")`

**Go:**
- `os.Getenv("VARIABLE_NAME")`

**General:**
- `.env` file variable names (if present)
- Docker compose environment sections
- Kubernetes ConfigMap/Secret references

### Step 4: Generate .env.example Content

Structure the output file:

```bash
# .env.example
# Generated by /env-example
# Copy to .env and fill in your values

# ===================
# AI / LLM Services
# ===================
# OpenAI - https://platform.openai.com/api-keys
OPENAI_API_KEY=your_openai_api_key_here

# Anthropic - https://console.anthropic.com/settings/keys
ANTHROPIC_API_KEY=your_anthropic_api_key_here

# ===================
# Payment Processing
# ===================
# Stripe - https://dashboard.stripe.com/apikeys
STRIPE_SECRET_KEY=your_stripe_secret_key_here
STRIPE_PUBLISHABLE_KEY=your_stripe_publishable_key_here
STRIPE_WEBHOOK_SECRET=your_stripe_webhook_secret_here

# ===================
# Database
# ===================
DATABASE_URL=your_database_url_here

# ===================
# Authentication
# ===================
NEXTAUTH_SECRET=your_nextauth_secret_here
NEXTAUTH_URL=http://localhost:3000

# ===================
# Other Services
# ===================
REDIS_URL=your_redis_url_here
```

### Step 5: Write File

1. Show preview of generated content
2. Ask for confirmation before writing
3. Write to `.env.example` in project root

## Arguments

| Argument | Description |
|----------|-------------|
| `/env-example` | Generate from 1Password + code scan (default) |
| `/env-example --1p-only` | Only include keys found in 1Password |
| `/env-example --code-only` | Only include vars found in code scan |
| `/env-example --sync` | Update existing .env.example, preserving custom comments |
| `/env-example --dry-run` | Preview output without writing file |

## Provider Categories

Group environment variables by these categories:

1. **AI / LLM Services** - OpenAI, Anthropic, Cohere, etc.
2. **Payment Processing** - Stripe, PayPal, etc.
3. **Database** - DATABASE_URL, connection strings
4. **Cache / Queue** - Redis, RabbitMQ, etc.
5. **Authentication** - NextAuth, Auth0, Clerk, etc.
6. **Email** - SendGrid, Resend, Postmark, etc.
7. **Storage** - AWS S3, Cloudflare R2, etc.
8. **Monitoring** - Sentry, LogRocket, etc.
9. **Other Services** - Everything else

## Dashboard URLs

Include dashboard URLs as comments for common providers:

| Provider | Dashboard URL |
|----------|--------------|
| OpenAI | https://platform.openai.com/api-keys |
| Anthropic | https://console.anthropic.com/settings/keys |
| Stripe | https://dashboard.stripe.com/apikeys |
| GitHub | https://github.com/settings/tokens |
| Vercel | https://vercel.com/account/tokens |
| SendGrid | https://app.sendgrid.com/settings/api_keys |
| Resend | https://resend.com/api-keys |
| Sentry | https://sentry.io/settings/account/api/auth-tokens/ |
| Clerk | https://dashboard.clerk.com/last-active?path=api-keys |
| Auth0 | https://manage.auth0.com/dashboard |
| Supabase | https://supabase.com/dashboard/project/_/settings/api |
| PlanetScale | https://app.planetscale.com |
| Neon | https://console.neon.tech |
| Upstash | https://console.upstash.com |

## MCP Tools

Use these env-var-assistant MCP tools:
- `list_api_keys` - Get all stored keys from 1Password
- `search_items` - Search for keys by project tag

## Sync Mode Behavior

When using `--sync`:

1. Read existing `.env.example`
2. Preserve all custom comments (lines starting with #)
3. Preserve grouping/sections
4. Add any new variables found in code or 1Password
5. Remove variables no longer used (with confirmation)
6. Keep placeholder values as-is

## Important

- NEVER include actual secret values
- Always use placeholder format: `your_variable_name_here`
- Include URLs only for where to GET keys, not API endpoints
- Preserve user's custom sections and comments in sync mode
